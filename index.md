# [Nimの基本](https://narimiran.github.io/nim-basics/)

Nimは、比較的新しいプログラミング言語で、読みやすく高性能なコードが書けます。ですが、Nimのチュートリアルを読んでいれば、おそらくNimについて既にご存知でしょう。

チュートリアルは [オンライン](https://narimiran.github.io/nim-basics/) もしくは [PDF](https://github.com/narimiran/nim-basics/raw/master/nim-basics.pdf) よりご覧いただけます。

なお、このドキュメントは未完成です。エラーが見つかったりこのドキュメントに改善点があれば、[issue tracker](https://github.com/narimiran/nim-basics/issues) までご連絡ください。

## 対象となる読者

* プログラミング経験がない、もしくは、乏しい方。
* 他のプログラミング言語の経験がある方。
* 1からNimを詳しく知りたい方。

## 対象とならない読者
* プログラミング経験豊富な方。より高度なチュートリアルの方が適しているでしょう。[チュートリアル](https://nim-lang.org/docs/tut1.html) または [Nim by Example](https://nim-by-example.github.io/) をご覧ください。
* Nimの経験がある方。(ドキュメントの改善にご協力ください)

## 本チュートリアルの使い方
本チュートリアルの目的は、プログラミングの基本およびNimの構文をお伝えすることです。そのため他のチュートリアルより簡単で、より深く追求できるようになります。

読むだけではなく、実行したり、例文を改造したり、自分で例文を考えたり、全体的に興味をもつとベストです。各章の終わりの演習問題は飛ばしてはいけません。交渉の余地なしです。

本チュートリアルの内容以上のことを知りたい場合、[Nimフォーラム](https://forum.nim-lang.org/)、[Nim Gitter channel](https://gitter.im/nim-lang/Nim)、[Discord Server](https://discordapp.com/invite/ezDFDw2)、NimのフリーノードIRCチャンネル(#nim)で質問してみてください。

## インストール
### Nimのインストール
Nimは主要3オペレーティングシステム向けにパッケージを提供しており、インストールに関しては複数のオプションがあります。

[公式インストール手順](https://nim-lang.org/install.html)に従って最新の安定版をインストールできます。また、最新の機能やバグ修正に興味がありましたら、最新の開発バージョンと安定版を簡単に切り替えられる[choosenim](https://github.com/dom96/choosenim)というツールを使うこともできます。

どちらにせよ、リンク先のインストール手順に従ってNimをインストールしてください。以下の章で、インストールがうまくいったか確認します。

Linuxをお使いであれば、高確率でディストリビューションのパッケージ・マネージャにNimが入っているはずです。この方法でインストールを行った場合は、最新バージョン（webサイトから確認してください）かどうか確認してください。それ以外の方法でインストールする場合は、上述の手順に従ってください。

本チュートリアルでは、現時点の安定版 Nim 0.19を使用します。

### Additional Toolsのインストール
任意のテキストエディタでNimのコードを記述し、ターミナルからコンパイルして実行できます。シンタックスハイライトや補完機能をお望みであれば、人気のエディタにはプラグインがあり、これらの機能が提供されています。

シンタックスハイライトと補完が使える[Nim Extension](https://marketplace.visualstudio.com/items?itemName=kosz78.nim)と、すぐにコンパイルと実行ができる[Code Runner Extension](https://marketplace.visualstudio.com/items?itemName=formulahendry.code-runner)を入れた[VS Code](https://code.visualstudio.com/)が筆者のお気に入りです。

他のエディターをお使いであれば、エディタのサポートについて[Wiki](https://github.com/nim-lang/Nim/wiki/Editor-Support)をご覧ください。

### インストールのテスト
インストールが成功したかどうか確認するため、入門の例題としてお決まりの[Hello World](https://en.wikipedia.org/wiki/%22Hello,_World!%22_program)を書いてみます。Nimでは、Hello World! の出力（プリンタで印刷するのではなく、画面上に表示）は簡潔で、おまじないも不要です。

`helloworld.nim` 等の新規ファイルに、下記の一行を書くだけです。

```helloworld.nim
echo "Hello World!"
```

*※出力したい文言は、`echo`コマンドの後ろに記述し、二重引用符（"）で囲む必要があります。*

まず、プログラムをコンパイルし、実行して期待通りの結果が得られるか見てみます。

ファイルがあるディレクトリ（Linuxの場合、ファイルマネージャを開いてディレクトリを右クリックし、「端末を開く」。Windowsの場合は、Shift + 右クリックして「コマンド ウィンドをここで開く」）

コンパイルするにはターミナル上で以下を入力します。

```Nim
nim c helloworld.nim
```

コンパイルが終了したら、プログラムが実行できるようになります。Linuxではターミナルから`./helloworld`と入力し、Windowsでは`helloworld.exe`と入力すれば実行できます。

1コマンドでコンパイルと実行を両方実行できます。以下を入力します。

```Nim
nim c -r helloworld.nim
```

*`c`オプションでコンパイル、`-r`オプションで即時実行。すべてのオプションを表示するにはターミナル上で`nim --help`と入力します。*

前述のCode Runnerを入れたVS Codeをご利用の場合は、`Ctrl+Alt+N`を入力すればコンパイルと実行が行われます。

いずれの方法で実行しても、すぐにウィンドウ（またはターミナル）に下記が表示されます。

```Nim
Hello World!
```

おめでとうございます！ はじめてののNimプログラムが正常に動作しました。

さて、これで画面上に何らかの文字を（`echo`コマンドを使用して）表示して、（ターミナル上で`nim c programName.nim`を入力して）コンパイルして、（様々な可能性のある）プログラムを実行する手段を知りました。

単純なNimプログラムを書くのに役立つ基本的な要素を追求し始めることができるようになりました。

## 命名の価値
プログラムの名前を大事にすると物事を追うのに役立ちます。ユーザに名前を尋ねるとして、後で使用するために保存しておきたいのです。それも、処理の度に何度も何度も尋ねないで、です。

`pi = 3.14`という例では、名前`pi`は値`3.14`と結びついています。経験上、変数`pi`は（10進）数だと言えます。

`firstName = Alice`という例では、`firstName`は`Alice`という値を持つ変数名です。この変数の型は語だと言えるでしょう。

プログラミング言語でも同様です。これらの代入は、*名前*、*値*、*型*を持ちます。

### 変数宣言
Nimは[静的型付け](https://en.wikipedia.org/wiki/Type_system#STATIC)プログラミング言語です。つまり、値を使用する前に代入の型を宣言する必要があります。

Nimでは、変更できる値とできない値を区別しますが、後ほど詳しく説明します。`var`キーワードを使用して変数（変更可能な代入）を宣言できます。下記構文を使用して名前と型を記述（値は後で追加できます）するだけです。

```Nim
var <名前>: <型>
```

あらかじめ値がわかっていれば、変数宣言の直後に値を渡せます。

```Nim
var <名前>: <型> = <値>
```

*山かっこ（`<>`）は変更可能であることを示すために使用しています。そのため、`<名前>`は、山かっこで囲まれた文字通りの単語ではなく、任意の名前です。*

Nimは[型推論](https://en.wikipedia.org/wiki/Type_inference)もあり、コンパイラは、型を明示的に指定しなくても、代入文の値から型を検出できます。次の章では、様々な変数の型を説明します。

以下のように、明示的な型を指定しなくても変数に代入できます。

```Nim
var <名前> = <値>
```

この例は下記のようになります。

```Nim
var a: int  [1]
var b = 7   [2]
```

* [1] 変数`a`はint（整数）型で、値は明示的に指定されていません。
* [2] 変数`b`の値は`7`です。型は自動的に整数として検出されます。

代入の際はプログラムにとって意味のある名前を選ぶことが重要です。単純に`a`、`b`、`c`といった具合に命名するとすぐに混乱するでしょう。名前にスペースを使用することはできません。名前が二つに分割されるためです。選択した名前が二つ以上の単語で構成されている場合、通常キャメルケース `camelCase` で記述します。（最初の文字は小文字である必要があります）

しかし、Nimは大文字と小文字を区別しないため、`helloWorld`と`hello_world`は同じ意味になります。これに対する例外は、大文字と小文字が区別される最初の文字です。名前には、数字、他のUTF-8の文字、もしお望みならば絵文字を含めることができますが、自分や他の人も入力しなければならないことに注意してください。

変数ごとに`var`と入力する代わりに、同じ`var`ブロック内で複数の変数（必ずしも同じ型である必要はありません）を宣言できます。Nimでは、ブロックは同じインデント（最初の文字の前にある同じ数のスペース）を持つコードの一部であり、デフォルトのインデントレベルはスペース2つです。このようなブロックは、代入部分に限ったことではなく、Nimプログラムのいたるところにがあります。 

```
var
  c = -11
  d = "Hello"
  e = '!'
```

*Nimでは、インデントに`Tab`を使用することはできません。`Tab`を任意の数のスペースに置き換えるようエディタを設定できます。VS Codeのデフォルト設定では、`Tab`から4つのスペースへの変換です。設定（`Ctrl+,`）から `"editor.tabSize": 2`を設定することでで簡単に上書きされます。*

前述のとおり変数は変更可能です。つまり、値は（複数回）変更される可能性がありますが、型は宣言時と同じものでなくてはなりません。

```Nim
var f = 7               [1]

f = -3                  [2]
f = 19
f = "Hello" # error     [3] [4]
```

* [1] 変数`f`の初期値は`7`で、`int`型とみなされます。
* [2] `f`の値はまず`-3`に変更され、次に`19`に変更されます。これらは両方とも整数で、元の値と同じです。
* [3] `Hello`は数値ではないため、`f`の値を `"Hello"` に変更しようとするとエラーとなり、`f`の型は整数から文字列に変更されます。
* [4] `＃エラー`はコメントです。コード中のコメントは`#`の後に記述します。以降、行内の記述はすべて無視されます。

### 不変代入
`var`キーワードで宣言された変数とは別に、Nimにはさらに2種類の代入が存在します。それらの値は変更できません。1つは`const`キーワードで宣言され、もう1つは`let`キーワードで宣言されます。

#### Const
`const`キーワードを使用して宣言された不変代入の値は、コンパイル時（プログラムの実行前）にわかっていなければなりません。

例えば、重力加速度を `const g = 9.81`、円周率を `const pi = 3.14` と宣言すると、これらの値はあらかじめわかっているためプログラムの実行中に変わることはありません。

```Nim
const g = 35
g = -27         # error [1]

var h = -5
const i = h + 7 # error [2]
```

* [1] 定数の値は変更できません。
* [2] 変数`h`はコンパイル時には評価されません（変数であり、値がプログラムの実行中に変わる可能性があります）。その結果、定数`i`の値はコンパイル時にはわからず、エラーになります。

プログラミング言語によっては、定数の名前を大文字で書くのが一般的な方法ですが、Nimの定数は他の変数と同じように記述します。

#### Let
`let`で宣言された不変代入はコンパイル時にわかっている必要はなく、値はプログラムの実行中いつでも設定できますが、一度設定すると変更できません。

```Nim
let j = 35
j = -27 # error [1]

var k = -5
let l = k + 7   [2]
```

* [1] 不変値は変更できません。
* [2] 前述の`const`の例とは違って、こちらは動作します。

実際は`const`より`let`のほうが頻繁に現れたり使用することになるでしょう。

いかなる場合でも`var`は使用できますが、基本的には`let`を使用すべきです。値を変更する場合のみ変数に`var`を使用してください。




---

## 注意
* 本ページは、Nimのドキュメントページを個人が翻訳したものです。
* 読みやすさを優先するため、一部意訳している箇所があります。
* 誤訳等による不利益等、いかなる場合においても責任は負いかねます。
